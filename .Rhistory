)
# Run regression
reg3 <- feols(ly ~ ceo_behavior * after + lemp + lempm + cons + active +
factor(year) + factor(cty) + emp_imputed + .[noise_basic_collapse] | company_id,
data = data_ba_collapsed,
weights = ~r_averagewk)
noise_basic_collapse <- c("pa", "reliability",
names(data)[grep("^ww|^aa", names(data))])
noise_basic_man <- c("pa", "reliability",
names(data)[grep("^reliability", names(data))])
data_ba <- read_dta("/Users/diegomoers/Desktop/REPLICATION ASSIGNMENT/2017765data/Regressions/Accounts_matched_beforeafter.dta")
noise_basic_collapse <- c("pa", "reliability",
names(data)[grep("^ww|^aa", names(data))])
noise_basic_man <- c("pa", "reliability",
names(data)[grep("^reliability", names(data))])
# Collapse data (group by and summarise)
data_ba_collapsed <- data_ba %>%
group_by(cty, company_id, sic, after) %>%
summarise(
emp_imputed = max(emp_imputed, na.rm = TRUE),
ly = mean(ly, na.rm = TRUE),
ceo_behavior = mean(ceo_behavior, na.rm = TRUE),
lemp = mean(lemp, na.rm = TRUE),
cons = mean(cons, na.rm = TRUE),
active = mean(active, na.rm = TRUE),
year = mean(year, na.rm = TRUE),
r_averagewk = mean(r_averagewk, na.rm = TRUE),
across(starts_with("noise"), ~ mean(.x, na.rm = TRUE))
) %>%
ungroup() %>%
mutate(
year = floor(year),
lemp = ifelse(is.na(lemp), -99, lemp),
lempm = (lemp == -99)
)
# Run regression
reg3 <- feols(ly ~ ceo_behavior * after + lemp + lempm + cons + active +
factor(year) + factor(cty) + emp_imputed + .[noise_basic_collapse] | company_id,
data = data_ba_collapsed,
weights = ~r_averagewk)
names(data_ba)
noise_basic_collapse <- c("pa", "reliability",
names(data)[grep("^ww|^aa", names(data))])
noise_basic_man <- c("pa", "reliability",
names(data)[grep("^reliability", names(data))])
noise_basic_collapse <- c("pa", "reliability",
names(data_before)[grep("^ww|^aa", names(data_before))])
# Column 3: Before-after analysis
# Load the data
data_ba <- read_dta("/Users/diegomoers/Desktop/REPLICATION ASSIGNMENT/2017765data/Regressions/Accounts_matched_beforeafter.dta")
# Collapse data (group by and summarise)
data_ba_collapsed <- data_ba %>%
group_by(cty, company_id, sic, after) %>%
summarise(
emp_imputed = max(emp_imputed, na.rm = TRUE),
ly = mean(ly, na.rm = TRUE),
ceo_behavior = mean(ceo_behavior, na.rm = TRUE),
lemp = mean(lemp, na.rm = TRUE),
cons = mean(cons, na.rm = TRUE),
active = mean(active, na.rm = TRUE),
year = mean(year, na.rm = TRUE),
r_averagewk = mean(r_averagewk, na.rm = TRUE),
across(starts_with("noise"), ~ mean(.x, na.rm = TRUE))
) %>%
ungroup() %>%
mutate(
year = floor(year),
lemp = ifelse(is.na(lemp), -99, lemp),
lempm = (lemp == -99)
)
# Run regression
reg3 <- feols(ly ~ ceo_behavior * after + lemp + lempm + cons + active +
factor(year) + factor(cty) + emp_imputed + .[noise_basic_collapse] | company_id,
data = data_ba_collapsed,
weights = ~r_averagewk)
# Identify variables matching the patterns in noise_basic_collapse
noise_basic_collapse <- c(
"pa",
"reliability",
grep("^ww", names(data_ba), value = TRUE),
grep("^aa", names(data_ba), value = TRUE)
)
# Column 3: Before-after analysis
# Load the data
data_ba <- read_dta("/Users/diegomoers/Desktop/REPLICATION ASSIGNMENT/2017765data/Regressions/Accounts_matched_beforeafter.dta")
# Collapse data (group by and summarise)
data_ba_collapsed <- data_ba %>%
group_by(cty, company_id, sic, after) %>%
summarise(
emp_imputed = max(emp_imputed, na.rm = TRUE),
ly = mean(ly, na.rm = TRUE),
ceo_behavior = mean(ceo_behavior, na.rm = TRUE),
lemp = mean(lemp, na.rm = TRUE),
cons = mean(cons, na.rm = TRUE),
active = mean(active, na.rm = TRUE),
year = mean(year, na.rm = TRUE),
r_averagewk = mean(r_averagewk, na.rm = TRUE),
across(starts_with("noise"), ~ mean(.x, na.rm = TRUE))
) %>%
ungroup() %>%
mutate(
year = floor(year),
lemp = ifelse(is.na(lemp), -99, lemp),
lempm = (lemp == -99)
)
# Run regression
reg3 <- feols(ly ~ ceo_behavior * after + lemp + lempm + cons + active +
factor(year) + factor(cty) + emp_imputed + .[noise_basic_collapse] | company_id,
data = data_ba_collapsed,
weights = ~r_averagewk)
print(noise_basic_collapse)  # Verify the variable names
missing_vars <- setdiff(noise_basic_collapse, names(data_ba))
if (length(missing_vars) > 0) {
cat("Missing variables:", paste(missing_vars, collapse = ", "))
}
# Column 3: Before-after analysis
# Load the data
data_ba <- read_dta("/Users/diegomoers/Desktop/REPLICATION ASSIGNMENT/2017765data/Regressions/Accounts_matched_beforeafter.dta")
# Collapse data (group by and summarise)
data_ba_collapsed <- data_ba %>%
group_by(cty, company_id, sic, after) %>%
summarise(
emp_imputed = max(emp_imputed, na.rm = TRUE),
ly = mean(ly, na.rm = TRUE),
ceo_behavior = mean(ceo_behavior, na.rm = TRUE),
lemp = mean(lemp, na.rm = TRUE),
cons = mean(cons, na.rm = TRUE),
active = mean(active, na.rm = TRUE),
year = mean(year, na.rm = TRUE),
r_averagewk = mean(r_averagewk, na.rm = TRUE),
across(starts_with("noise"), ~ mean(.x, na.rm = TRUE))
) %>%
ungroup() %>%
mutate(
year = floor(year),
lemp = ifelse(is.na(lemp), -99, lemp),
lempm = (lemp == -99)
)
# Run regression
reg3 <- feols(ly ~ ceo_behavior * after + lemp + lempm + cons + active +
factor(year) + factor(cty) + emp_imputed + .[noise_basic_collapse] | company_id,
data = data_ba_collapsed,
weights = ~r_averagewk)
# Collapse data (group by and summarise)
data_ba_collapsed <- data_ba %>%
group_by(cty, company_id, sic, after) %>%
summarise(
emp_imputed = max(emp_imputed, na.rm = TRUE),
ly = mean(ly, na.rm = TRUE),
ceo_behavior = mean(ceo_behavior, na.rm = TRUE),
lemp = mean(lemp, na.rm = TRUE),
cons = mean(cons, na.rm = TRUE),
active = mean(active, na.rm = TRUE),
year = mean(year, na.rm = TRUE),
r_averagewk = mean(r_averagewk, na.rm = TRUE),
across(starts_with("noise"), ~ mean(.x, na.rm = TRUE))
) %>%
ungroup() %>%
mutate(
year = floor(year),
lemp = ifelse(is.na(lemp), -99, lemp),
lempm = (lemp == -99)
)
View(data_collapsed)
# Column 3: Before-after analysis
data_ba <- read_dta("/Users/diegomoers/Desktop/REPLICATION ASSIGNMENT/2017765data/Regressions/Accounts_matched_beforeafter.dta")
data_ba_collapsed <- data_ba %>%
group_by(cty, company_id, sic, after) %>%
summarise(
emp_imputed = max(emp_imputed),
ly = mean(ly),
ceo_behavior = mean(ceo_behavior),
lemp = mean(lemp),
cons = mean(cons),
active = mean(active),
year = mean(year),
r_averagewk = mean(r_averagewk),
across(all_of(noise_basic_collapse), mean)
) %>%
ungroup() %>%
mutate(
year = floor(year),
lemp = ifelse(is.na(lemp), -99, lemp),
lempm = lemp == -99
)
# Print results in a similar format to the paper
etable(reg1, reg2, reg3, reg4, reg5,
keep = c("ceo_behavior", "year_tenure", "::", "lemp"),
signif.code = c("*" = .1, "**" = .05, "***" = .01))
# Column 4: Split after period in two
data_ba2 <- read_dta("Accounts_matched_beforeafter.dta")
# Column 4: Split after period in two
data_ba2 <- read_dta("/Users/diegomoers/Desktop/REPLICATION ASSIGNMENT/2017765data/Regressions/Accounts_matched_beforeafter.dta")
data_ba2_collapsed <- data_ba2 %>%
group_by(cty, company_id, sic, after2) %>%
summarise(
emp_imputed = max(emp_imputed),
ly = mean(ly),
ceo_behavior = mean(ceo_behavior),
lemp = mean(lemp),
cons = mean(cons),
active = mean(active),
year = mean(year),
r_averagewk = mean(r_averagewk),
across(all_of(noise_basic_collapse), mean)
) %>%
ungroup() %>%
mutate(
year = floor(year),
lemp = ifelse(is.na(lemp), -99, lemp),
lempm = lemp == -99
)
reg4 <- feols(ly ~ ceo_behavior * after2 + lemp + lempm + cons + active +
factor(year) + factor(cty) + emp_imputed +
.[noise_basic_collapse] | company_id,
data = data_ba2_collapsed,
weights = ~r_averagewk)
# Column 5: Early tenure CEOs
data_ba3 <- data_ba2 %>%
filter(i_posttenure <= 3)
data_ba3_collapsed <- data_ba3 %>%
group_by(cty, company_id, sic, after2) %>%
summarise(
emp_imputed = max(emp_imputed),
ly = mean(ly),
ceo_behavior = mean(ceo_behavior),
lemp = mean(lemp),
cons = mean(cons),
active = mean(active),
year = mean(year),
r_averagewk = mean(r_averagewk),
across(all_of(noise_basic_collapse), mean)
) %>%
ungroup() %>%
mutate(
year = floor(year),
lemp = ifelse(is.na(lemp), -99, lemp),
lempm = lemp == -99
)
reg5 <- feols(ly ~ ceo_behavior * after2 + lemp + lempm + cons + active +
factor(year) + factor(cty) + emp_imputed +
.[noise_basic_collapse] | company_id,
data = data_ba3_collapsed,
weights = ~r_averagewk)
# Print results in a similar format to the paper
etable(reg1, reg2, reg3, reg4, reg5,
keep = c("ceo_behavior", "year_tenure", "::", "lemp"),
signif.code = c("*" = .1, "**" = .05, "***" = .01))
nrow(data_ba2_collapsed)
table(data_ba2$i_posttenure)  # Inspect the distribution of `i_posttenure`
reg4_test <- feols(ly ~ ceo_behavior * after2 + lemp + lempm + cons + active +
factor(year) + factor(cty) + emp_imputed + .[noise_basic_collapse],
data = data_ba2_collapsed)
summary(reg4_test)
# Load required libraries
library(fixest)
library(dplyr)
library(haven)
library(broom)
# Load the dataset
data <- read_dta("/path/to/Accounts_matched_collapsed.dta")
# Load required libraries
library(fixest)
library(dplyr)
library(haven)
library(broom)
# Load the dataset
data <- read_dta("/Users/diegomoers/Desktop/REPLICATION ASSIGNMENT/2017765data/Regressions/Accounts_matched_collapsed.dta")
# Function to standardize variables
standardize_vars <- function(df, vars) {
for (var in vars) {
if (var %in% names(df)) {
df[[var]] <- as.numeric(scale(df[[var]]))
}
}
return(df)
}
# Define variables to standardize
std_vars <- c("ceo_behavior", grep("^w_r_", names(data), value = TRUE))
data <- standardize_vars(data, std_vars)
# Define function to run regressions
run_regressions <- function(data, y_vars, fixed_effects = "sic", cluster = "sic", extra_vars = "") {
results <- list()
for (y in y_vars) {
if (y %in% names(data)) {
formula <- paste0("ly ~ ", y, " + lemp + lempm + cons + active + ",
extra_vars, "factor(year) + factor(cty) + emp_imputed + ",
".[noise_basic_collapse] | ", fixed_effects)
model <- feols(as.formula(formula), data = data, weights = ~r_averagewk, cluster = ~get(cluster))
results[[y]] <- model
}
}
return(results)
}
# Regression variables
y_vars_3_11 <- paste0("w_r_", 3:11)
y_vars_15_20 <- c("w_r_15", "w_r_20")
# Run regressions for basic variables
reg_results_3_11 <- run_regressions(data, y_vars_3_11)
reg_results_15_20 <- run_regressions(data, y_vars_15_20)
# Add capital and materials
data <- data %>% mutate(lk = ifelse(is.na(lk), 0, lk), lm = ifelse(is.na(lm), 0, lm))
reg_results_capital <- run_regressions(data, c(y_vars_3_11, y_vars_15_20), extra_vars = "lk + lm + ")
# Filter public firms
data_public <- filter(data, f_public == 1)
reg_results_public <- run_regressions(data_public, c(y_vars_3_11, y_vars_15_20), extra_vars = "lk + lm + ")
# Add zmanagement and rerun regressions
data <- data %>% filter(!is.na(zmanagement)) %>%
mutate(zmanagement = scale(zmanagement))
reg_results_zmanagement <- run_regressions(data, c(y_vars_3_11, y_vars_15_20), extra_vars = "zmanagement + ")
# Load profits dataset and rerun
data_profits <- read_dta("/path/to/Accounts_matched_collapsed_profits.dta")
# Load required libraries
library(fixest)
library(dplyr)
library(haven)
library(broom)
# Load the dataset
data <- read_dta("/Users/diegomoers/Desktop/REPLICATION ASSIGNMENT/2017765data/Regressions/Accounts_matched_collapsed.dta")
# Function to standardize variables
standardize_vars <- function(df, vars) {
for (var in vars) {
if (var %in% names(df)) {
df[[var]] <- as.numeric(scale(df[[var]]))
}
}
return(df)
}
# Define variables to standardize
std_vars <- c("ceo_behavior", grep("^w_r_", names(data), value = TRUE))
data <- standardize_vars(data, std_vars)
# Define function to run regressions
run_regressions <- function(data, y_vars, fixed_effects = "sic", cluster = "sic", extra_vars = "") {
results <- list()
for (y in y_vars) {
if (y %in% names(data)) {
formula <- paste0("ly ~ ", y, " + lemp + lempm + cons + active + ",
extra_vars, "factor(year) + factor(cty) + emp_imputed + ",
".[noise_basic_collapse] | ", fixed_effects)
model <- feols(as.formula(formula), data = data, weights = ~r_averagewk, cluster = ~get(cluster))
results[[y]] <- model
}
}
return(results)
}
# Regression variables
y_vars_3_11 <- paste0("w_r_", 3:11)
y_vars_15_20 <- c("w_r_15", "w_r_20")
# Run regressions for basic variables
reg_results_3_11 <- run_regressions(data, y_vars_3_11)
reg_results_15_20 <- run_regressions(data, y_vars_15_20)
# Add capital and materials
data <- data %>% mutate(lk = ifelse(is.na(lk), 0, lk), lm = ifelse(is.na(lm), 0, lm))
reg_results_capital <- run_regressions(data, c(y_vars_3_11, y_vars_15_20), extra_vars = "lk + lm + ")
# Filter public firms
data_public <- filter(data, f_public == 1)
reg_results_public <- run_regressions(data_public, c(y_vars_3_11, y_vars_15_20), extra_vars = "lk + lm + ")
# Add zmanagement and rerun regressions
data <- data %>% filter(!is.na(zmanagement)) %>%
mutate(zmanagement = scale(zmanagement))
reg_results_zmanagement <- run_regressions(data, c(y_vars_3_11, y_vars_15_20), extra_vars = "zmanagement + ")
# Load profits dataset and rerun
data_profits <- read_dta("/Users/diegomoers/Desktop/REPLICATION ASSIGNMENT/2017765data/Regressions/Accounts_matched_collapsed_profits.dta")
data_profits <- standardize_vars(data_profits, std_vars)
reg_results_profits <- run_regressions(data_profits, c(y_vars_3_11, y_vars_15_20), fixed_effects = "sic2", cluster = "sic2")
# Save results to a table
etable(
reg_results_3_11, reg_results_15_20, reg_results_capital, reg_results_public, reg_results_zmanagement, reg_results_profits,
keep = c("w_*", "ceo_behavior", "lemp"),
signif.code = c("*" = 0.1, "**" = 0.05, "***" = 0.01),
stats = c("r2", "nobs"),
label = TRUE
)
# Load required libraries
library(fixest)
library(dplyr)
library(haven)
library(broom)
# Load the dataset
data <- read_dta("/Users/diegomoers/Desktop/REPLICATION ASSIGNMENT/2017765data/Regressions/Accounts_matched_collapsed.dta")
# Function to standardize variables
standardize_vars <- function(df, vars) {
for (var in vars) {
if (var %in% names(df)) {
df[[var]] <- as.numeric(scale(df[[var]]))
}
}
return(df)
}
# Define variables to standardize
std_vars <- c("ceo_behavior", grep("^w_r_", names(data), value = TRUE))
data <- standardize_vars(data, std_vars)
# Define function to run regressions
run_regressions <- function(data, y_vars, fixed_effects = "sic", cluster = "sic", extra_vars = "") {
results <- list()
for (y in y_vars) {
if (y %in% names(data)) {
formula <- paste0("ly ~ ", y, " + lemp + lempm + cons + active + ",
extra_vars, "factor(year) + factor(cty) + emp_imputed + ",
".[noise_basic_collapse] | ", fixed_effects)
model <- feols(as.formula(formula), data = data, weights = ~r_averagewk, cluster = ~get(cluster))
results[[y]] <- model
}
}
return(results)
}
# Regression variables
y_vars_3_11 <- paste0("w_r_", 3:11)
y_vars_15_20 <- c("w_r_15", "w_r_20")
# Run regressions for basic variables
reg_results_3_11 <- run_regressions(data, y_vars_3_11)
reg_results_15_20 <- run_regressions(data, y_vars_15_20)
# Add capital and materials
data <- data %>% mutate(lk = ifelse(is.na(lk), 0, lk), lm = ifelse(is.na(lm), 0, lm))
reg_results_capital <- run_regressions(data, c(y_vars_3_11, y_vars_15_20), extra_vars = "lk + lm + ")
# Filter public firms
data_public <- filter(data, f_public == 1)
reg_results_public <- run_regressions(data_public, c(y_vars_3_11, y_vars_15_20), extra_vars = "lk + lm + ")
# Add zmanagement and rerun regressions
data <- data %>% filter(!is.na(zmanagement)) %>%
mutate(zmanagement = scale(zmanagement))
reg_results_zmanagement <- run_regressions(data, c(y_vars_3_11, y_vars_15_20), extra_vars = "zmanagement + ")
# Load profits dataset and rerun
data_profits <- read_dta("/Users/diegomoers/Desktop/REPLICATION ASSIGNMENT/2017765data/Regressions/Accounts_matched_collapsed_profits.dta")
data_profits <- standardize_vars(data_profits, std_vars)
reg_results_profits <- run_regressions(data_profits, c(y_vars_3_11, y_vars_15_20), fixed_effects = "sic2", cluster = "sic2")
#save results
etable(reg_results_3_11, reg_results_15_20, reg_results_capital, reg_results_public, reg_results_zmanagement, reg_results_profits,
keep = c("ceo_behavior", "year_tenure", "::", "lemp"),
signif.code = c("*" = .1, "**" = .05, "***" = .01))
etable(reg_results_3_11, reg_results_15_20, reg_results_capital, reg_results_public, reg_results_zmanagement, reg_results_profits,
keep = c("ceo_behavior", "year_tenure", "lemp"),
signif.code = c("*" = .1, "**" = .05, "***" = .01))
etable(reg_results_3_11, reg_results_15_20, reg_results_capital, reg_results_public, reg_results_zmanagement, reg_results_profits,
keep = c("ceo_behavior", "year_tenure", "lemp"),
signif.code = c("*" = .1, "**" = .05, "***" = .01))
etable(reg_results_3_11, reg_results_15_20, reg_results_capital, reg_results_public, reg_results_zmanagement, reg_results_profits,
keep = c("ceo_behavior", "year_tenure", "lemp"),
signif.code = c("*" = .1, "**" = .05, "***" = .01))
# Load required libraries
library(fixest)
library(dplyr)
library(haven)
library(broom)
# Load the dataset
data <- read_dta("/Users/diegomoers/Desktop/REPLICATION ASSIGNMENT/2017765data/Regressions/Accounts_matched_collapsed.dta")
# Function to standardize variables
standardize_vars <- function(df, vars) {
for (var in vars) {
if (var %in% names(df)) {
df[[var]] <- as.numeric(scale(df[[var]]))
}
}
return(df)
}
# Define variables to standardize
std_vars <- c("ceo_behavior", grep("^w_r_", names(data), value = TRUE))
data <- standardize_vars(data, std_vars)
# Define function to run regressions
run_regressions <- function(data, y_vars, fixed_effects = "sic", cluster = "sic", extra_vars = "") {
results <- list()
for (y in y_vars) {
if (y %in% names(data)) {
formula <- paste0("ly ~ ", y, " + lemp + lempm + cons + active + ",
extra_vars, "factor(year) + factor(cty) + emp_imputed + ",
".[noise_basic_collapse] | ", fixed_effects)
model <- feols(as.formula(formula), data = data, weights = ~r_averagewk, cluster = ~get(cluster))
results[[y]] <- model
}
}
return(results)
}
# Regression variables
y_vars_3_11 <- paste0("w_r_", 3:11)
y_vars_15_20 <- c("w_r_15", "w_r_20")
# Run regressions for basic variables
reg_results_3_11 <- run_regressions(data, y_vars_3_11)
reg_results_15_20 <- run_regressions(data, y_vars_15_20)
# Add capital and materials
data <- data %>% mutate(lk = ifelse(is.na(lk), 0, lk), lm = ifelse(is.na(lm), 0, lm))
reg_results_capital <- run_regressions(data, c(y_vars_3_11, y_vars_15_20), extra_vars = "lk + lm + ")
# Filter public firms
data_public <- filter(data, f_public == 1)
reg_results_public <- run_regressions(data_public, c(y_vars_3_11, y_vars_15_20), extra_vars = "lk + lm + ")
# Add zmanagement and rerun regressions
data <- data %>% filter(!is.na(zmanagement)) %>%
mutate(zmanagement = scale(zmanagement))
reg_results_zmanagement <- run_regressions(data, c(y_vars_3_11, y_vars_15_20), extra_vars = "zmanagement + ")
# Load profits dataset and rerun
data_profits <- read_dta("/Users/diegomoers/Desktop/REPLICATION ASSIGNMENT/2017765data/Regressions/Accounts_matched_collapsed_profits.dta")
data_profits <- standardize_vars(data_profits, std_vars)
reg_results_profits <- run_regressions(data_profits, c(y_vars_3_11, y_vars_15_20), fixed_effects = "sic2", cluster = "sic2")
#save results
etable(reg_results_3_11, reg_results_15_20, reg_results_capital, reg_results_public, reg_results_zmanagement, reg_results_profits,
keep = c("ceo_behavior", "year_tenure", "lemp"),
signif.code = c("*" = .1, "**" = .05, "***" = .01))
# Inspect each regression object
str(reg_results_3_11)
str(reg_results_15_20)
str(reg_results_capital)
str(reg_results_public)
str(reg_results_zmanagement)
str(reg_results_profits)
# Combine all models into a list
all_models <- c(reg_results_3_11, reg_results_15_20, reg_results_capital,
reg_results_public, reg_results_zmanagement, reg_results_profits)
# Print each model's summary
for (i in seq_along(all_models)) {
cat("\n--- Model", i, "---\n")
print(summary(all_models[[i]]))
}
summary(reg_results_15_20)
